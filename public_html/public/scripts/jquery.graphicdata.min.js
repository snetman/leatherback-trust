$(document).ready(function(){function e(e,t){var a=d.length,s=e,i=s+t,n=i+"Max",o=T.data(n),c=$(".node-wrapper").width(),p=100/a+"%",v=c/a,h=Math.floor(c*l*.01);d.each(function(){var e=$(this),t=$(this).find(".node-inner"),a=e.find(".node-count"),l=$(this).data(i);a.text(l);var d=p,n=l/o,c=Math.floor(n*h);r>c&&(c=r),e.css({width:d,height:c+"px"}),t.css({height:c+"px"});var u=10*(a.text().length+2),x=20;c>=u&&v>=x?a.removeClass("hide-me"):a.addClass("hide-me"),e.attr("data-species",s)})}function t(e){var t=$(".node-tooltip"),a=t.width(),s=t.parent().width(),i=e-.5*a,r=e+.5*a,l=r-s,d=0-i;l>0?(e-=l,t.addClass("is-adjusted")):d>0?(e+=d,t.addClass("is-adjusted")):t.removeClass("is-adjusted"),t.css({left:e})}function a(e,t,a){var s=$(".node-tooltip");""!=e&&s.find(".tooltip-stat").text(e),""!=t&&s.find(".tooltip-type").text(t),""!=a&&s.find(".tooltip-year").text(a)}function s(e,t){var a=$(".node-tooltip");a.find(e).text(t)}function i(){if(new Date-M<f)setTimeout(i,f);else{g=!1;var t=$("#SpeciesSelect .is-active a").attr("data-species"),a=$("#TypeSelect .is-active a").attr("data-type");e(t,a)}}var r=1,l=33.333333333,d=$(".node"),n=$('#TurtlesOverTime td[data-species="leatherback"]'),o=$('#NestsOverTime td[data-species="leatherback"]'),c=$('#TurtlesOverTime td[data-species="oliveridley"]'),p=$('#NestsOverTime td[data-species="oliveridley"]'),v=$('#TurtlesOverTime td[data-species="green"]'),h=$('#NestsOverTime td[data-species="green"]'),u=$('#TurtlesOverTime th[data-species="all"]'),x=$('#NestsOverTime th[data-species="all"]'),T=$(".node-wrapper");T.data({leatherbackTurtlesMax:0,leatherbackNestsMax:0,oliveridleyTurtlesMax:0,oliveridleyNestsMax:0,greenTurtlesMax:0,greenNestsMax:0,allTurtlesMax:0,allNestsMax:0}),d.each(function(e){var t=$(this).attr("data-year"),a=parseInt(n.eq(e).text().replace(/,/g,""),10),s=parseInt(o.eq(e).text().replace(/,/g,""),10),i=parseInt(c.eq(e).text().replace(/,/g,""),10),r=parseInt(p.eq(e).text().replace(/,/g,""),10),l=parseInt(v.eq(e).text().replace(/,/g,""),10),d=parseInt(h.eq(e).text().replace(/,/g,""),10),M=parseInt(u.eq(e).text().replace(/,/g,""),10),g=parseInt(x.eq(e).text().replace(/,/g,""),10);$(this).data({y:t,leatherbackTurtles:a,leatherbackNests:s,oliveridleyTurtles:i,oliveridleyNests:r,greenTurtles:l,greenNests:d,allTurtles:M,allNests:g}),a>T.data("leatherbackTurtlesMax")&&T.data("leatherbackTurtlesMax",a),s>T.data("leatherbackNestsMax")&&T.data("leatherbackNestsMax",s),i>T.data("oliveridleyTurtlesMax")&&T.data("oliveridleyTurtlesMax",i),r>T.data("oliveridleyNestsMax")&&T.data("oliveridleyNestsMax",r),l>T.data("greenTurtlesMax")&&T.data("greenTurtlesMax",l),d>T.data("greenNestsMax")&&T.data("greenNestsMax",d),M>T.data("allTurtlesMax")&&T.data("allTurtlesMax",M),g>T.data("allNestsMax")&&T.data("allNestsMax",g)}),d.hover(function(){$(".node-tooltip").addClass("is-active");var e=$(this),s=e.find(".node-count").text(),i=e.attr("data-year"),r="",l=e.position(),d=e.width(),n=l.left+.5*d;a(s,r,i),t(n)},function(){$(".node-tooltip").removeClass("is-active")});var M=new Date(1,1,2e3,12,0,0),g=!1,f=200;$(window).resize(function(){M=new Date,g===!1&&(g=!0,setTimeout(i,f))}),$("#DataSelect a").click(function(){var t=$(this).parents(".drop-select");t.toggleClass("is-open"),$(this).parent().siblings(".is-active").removeClass("is-active"),$(this).parent().addClass("is-active");var a=$("#SpeciesSelect .is-active a").attr("data-species"),i=$("#TypeSelect .is-active a").attr("data-type"),r=$(this).attr("data-species"),l=$(this).attr("data-type");return r&&(a=r),l&&(i=l),e(a,i),s(".tooltip-type",i),$(".node-tooltip").attr("data-species",a),!1}),e("leatherback","Turtles")});