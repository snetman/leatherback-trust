$(document).ready(function(){function e(e,t){var a=l.length,s=e,d=s+t,n=d+"Max",c=x.data(n),o=$(".node-wrapper").width(),p=100/a+"%",v=o/a,h=Math.floor(o*i*.01);l.each(function(){var e=$(this),t=$(this).find(".node-inner"),a=e.find(".node-count"),i=$(this).data(d);a.text(i);var l=p,n=i/c,o=Math.floor(n*h);r>o&&(o=r),e.css({width:l,height:o+"px"}),t.css({height:o+"px"});var u=10*(a.text().length+2),x=20;o>=u&&v>=x?a.removeClass("hide-me"):a.addClass("hide-me"),e.attr("data-species",s)})}function t(e){var t=$(".node-tooltip"),a=t.width(),s=t.parent().width(),r=e-.5*a,i=e+.5*a,l=i-s,d=0-r;l>0?(e-=l,t.addClass("is-adjusted")):d>0?(e+=d,t.addClass("is-adjusted")):t.removeClass("is-adjusted"),t.css({left:e})}function a(e,t){var a=$(".node-tooltip");""!==e&&a.find(".tooltip-stat").text(e),""!==t&&a.find(".tooltip-year").text(t)}function s(){if(new Date-T<g)setTimeout(s,g);else{M=!1;var t=$("#SpeciesSelect .is-active a").attr("data-species"),a=$("#TypeSelect .is-active a").attr("data-type");e(t,a)}}var r=1,i=33.333333333,l=$(".node"),d=$('#TurtlesOverTime td[data-species="leatherback"]'),n=$('#NestsOverTime td[data-species="leatherback"]'),c=$('#TurtlesOverTime td[data-species="oliveridley"]'),o=$('#NestsOverTime td[data-species="oliveridley"]'),p=$('#TurtlesOverTime td[data-species="green"]'),v=$('#NestsOverTime td[data-species="green"]'),h=$('#TurtlesOverTime th[data-species="all"]'),u=$('#NestsOverTime th[data-species="all"]'),x=$(".node-wrapper");x.data({leatherbackTurtlesMax:0,leatherbackNestsMax:0,oliveridleyTurtlesMax:0,oliveridleyNestsMax:0,greenTurtlesMax:0,greenNestsMax:0,allTurtlesMax:0,allNestsMax:0}),l.each(function(e){var t=$(this).attr("data-year"),a=parseInt(d.eq(e).text().replace(/,/g,""),10),s=parseInt(n.eq(e).text().replace(/,/g,""),10),r=parseInt(c.eq(e).text().replace(/,/g,""),10),i=parseInt(o.eq(e).text().replace(/,/g,""),10),l=parseInt(p.eq(e).text().replace(/,/g,""),10),T=parseInt(v.eq(e).text().replace(/,/g,""),10),M=parseInt(h.eq(e).text().replace(/,/g,""),10),g=parseInt(u.eq(e).text().replace(/,/g,""),10);$(this).data({y:t,leatherbackTurtles:a,leatherbackNests:s,oliveridleyTurtles:r,oliveridleyNests:i,greenTurtles:l,greenNests:T,allTurtles:M,allNests:g}),a>x.data("leatherbackTurtlesMax")&&x.data("leatherbackTurtlesMax",a),s>x.data("leatherbackNestsMax")&&x.data("leatherbackNestsMax",s),r>x.data("oliveridleyTurtlesMax")&&x.data("oliveridleyTurtlesMax",r),i>x.data("oliveridleyNestsMax")&&x.data("oliveridleyNestsMax",i),l>x.data("greenTurtlesMax")&&x.data("greenTurtlesMax",l),T>x.data("greenNestsMax")&&x.data("greenNestsMax",T),M>x.data("allTurtlesMax")&&x.data("allTurtlesMax",M),g>x.data("allNestsMax")&&x.data("allNestsMax",g)}),l.hover(function(){$(".node-tooltip").addClass("is-active");var e=$(this),s=e.find(".node-count").text(),r=e.attr("data-year"),i=e.position(),l=e.width(),d=i.left+.5*l;a(s,r),t(d)},function(){$(".node-tooltip").removeClass("is-active")});var T=new Date(1,1,2e3,12,0,0),M=!1,g=200;$(window).resize(function(){T=new Date,M===!1&&(M=!0,setTimeout(s,g))}),$("#DataSelect a").click(function(){var t=$(this).parents(".drop-select");t.toggleClass("is-open"),$(this).parent().siblings(".is-active").removeClass("is-active"),$(this).parent().addClass("is-active");var a=$("#SpeciesSelect .is-active a").attr("data-species"),s=$("#TypeSelect .is-active a").attr("data-type"),r=$(this).attr("data-species"),i=$(this).attr("data-type");return r&&(a=r),i&&(s=i),e(a,s),$(".node-tooltip").attr("data-species",a),!1}),e("leatherback","Turtles")});